$(function(){$("body").on("click",'[name="select_all"]',function(){var b=$(this).is(":checked");$('[name="select_item"]').each(function(c,g){var f=$(this),d=f.prop("disabled");
if(d){f.prop("checked",false);}else{f.prop("checked",b);}});});$("body").on("click",'[name="select_item"]',function(){var c=$('[name="select_item"]').length,b=$('[name="select_item"]:checked').length;
if(c==b){$('[name="select_all"]').prop("checked",true);}else{$('[name="select_all"]').prop("checked",false);}});var a=false;window.addEventListener("pageshow",function(){if(a){window.location.reload();
}});window.addEventListener("pagehide",function(){a=true;});});(function(b,h){var a={Get:function(j){var d=h.cookie.match(new RegExp("(^| )"+j+"=([^;]*)(;|$)"));
if(d!=null){return unescape(d[2]);}return null;},Set:function(d,k,m){var j=m,l=new Date();l.setTime(l.getTime()+j*24*60*60*1000);h.cookie=d+"="+escape(k)+";expires="+l.toGMTString();
}};var e={Email:/\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/,Account:/^[a-zA-Z0-9_]{2,20}$/,Pwd:/^[a-zA-Z0-9_~!@#$%^&*()]{6,25}$/i,Tel:/^(13|14|15|16|17|18|19)[0-9]{9}$/,IDCard:/^\d{17}[\d|X|x]|\d{15}$/,Number:/^\d+$/,Integer:/^[-\+]?\d+$/,IntegerZ:/^[1-9]\d*$/,IntegerF:/^-[1-9]\d*$/,Chinese:/^[\u0391-\uFFE5]+$/,Zipcode:/^\d{6}$/,Authcode:/^\d{6}$/,QQ:/^\d{4,12}$/,Price:/^(0|[1-9]\d*)(\.\d{1,2})?$/,Money:/^(0|[1-9]\d*)(\.\d{1,4})?$/,Letter:/^[A-Za-z]+$/,LetterU:/^[A-Z]+$/,LetterL:/^[a-z]+$/,Url:/^http:\/\/[A-Za-z0-9]+\.[A-Za-z0-9]+[\/=\?%\-&_~`@[\]\':+!]*([^<>\"\"])*$/,Date:/^\d{4}(\-|\/|\.)\d{1,2}\1\d{1,2}$/,Domain:/^[a-zA-Z0-9]{4,}$/};
var g="csrf_cookie_name";function c(j){if(j==undefined){j={};}var d={csrf_token_name:a.Get(g),rdm:Math.random()};return $.extend(d,j);}function f(d){var j=new RegExp("(^|&)"+d+"=([^&]*)(&|$)"),k=window.location.search.substr(1).match(j);
if(k!=null){return unescape(k[2]);}return null;}function i(n,j,k,l){var m=null;l=l||60;if(!j){layer.open({content:"手机号不能为空",skin:"msg",time:1});return false;
}else{if(!e.Tel.test(j)){layer.open({content:"手机号格式不正确",skin:"msg",time:1});return false;}}function d(){if(l<=0){clearTimeout(m);n.prop("disabled",false).text("获取验证码");
return false;}n.prop("disabled",true).text(l+"s后重发");l--;}n.prop("disabled",true);$.post(__BASEURL__+"api/mobile_api/send_code",c({mobile:j,type:k}),function(o){if(o.success){layer.open({content:"获取成功",skin:"msg",time:1});
d();m=setInterval(d,1000);}else{layer.open({content:o.msg,skin:"msg",time:1});n.prop("disabled",false).text("获取验证码");}},"json");}b.Cookie=a;b.PregRule=e;
b.autoCsrf=c;b.GetQueryString=f;b.getAuthCode=i;})(window,document);(function(b,e){function a(i,h,d,k){var g=e.getElementById(i);function j(){var l=c(h,d),m=null;
if(l.total>=0){g.innerHTML=f(l.minutes)+":"+f(l.seconds);m=setTimeout(j,1000);}else{clearTimeout(m);k&&k();}}j();}function c(i,g){var j=Date.parse(g)-Date.parse(new Date())-i,l=Math.floor(j/(1000*60*60*24)),d=Math.floor(j/(1000*60*60)%24),h=Math.floor(j/(1000*60)%60),k=Math.floor(j/1000%60);
return{total:j,days:l,hours:d,minutes:h,seconds:k};}function f(d){var g;if(d<10){g="0"+d;}else{g=d;}return g;}b.initCountDown=a;})(window,document);(function(a,c){function b(){this.key="SHOPCART";
}b.prototype.getCart=function(){var d=JSON.parse(localStorage.getItem(this.key));if(!d){d={goods:[],total_amount:0,total_price:"0.00",total_box:"0.00"};
}return d;};b.prototype.saveCart=function(d){localStorage.setItem(this.key,JSON.stringify(d));};b.prototype.clearCart=function(){var d={goods:[],total_amount:0,total_price:"0.00",total_box:"0.00"};
this.saveCart(d);};b.prototype.addGood=function(j){var g=this.getCart();var k=false;for(var f=0,d=g.goods.length;f<d;f++){if(g.goods[f].sku_id==j.sku_id){g.goods[f].amount=parseInt(g.goods[f].amount)+parseInt(j.amount);
k=true;}}var m="";var e="";var h="";if(j.promo_setting){if(j.promo_limit_buy>=j.amount){if(j.promo_setting.discount_name=="打折"){m=j.price;h=j.promo_limit_buy;
j.price=j.promo_setting.dec_input*j.price;e=j.price;}else{m=j.price;h=j.promo_limit_buy;j.price=j.price-j.promo_setting.dec_input;e=j.price;}}}if(!k){g.goods.push({id:j.id,sku_id:j.sku_id,promo_setting:j.promo_setting,promo_limit_buy:j.promo_limit_buy,attr_name:j.attr_name,title:j.title,dec_price:m,promo_price:e,number:h,sku_type:j.sku_type,sku_number:j.sku_number,pict_url:j.pict_url,price:parseFloat(j.price).toFixed(2),amount:parseInt(j.amount),box_fee:parseFloat(j.box_fee).toFixed(2)});
}g.total_amount=parseInt(g.total_amount)+parseInt(j.amount);g.total_price=(parseFloat(g.total_price)+parseInt(j.amount)*parseFloat(j.price)).toFixed(2);
g.total_box=(parseFloat(g.total_box)+parseInt(j.amount)*parseFloat(j.box_fee)).toFixed(2);this.saveCart(g);};b.prototype.updateGood=function(j,g){var h=this.getCart();
for(var f=0,d=h.goods.length;f<d;f++){if(h.goods[f].sku_id==j){if(h.goods[f].promo_setting){if(h.goods[f].promo_setting.discount_name=="打折"){if(g>h.goods[f].amount){if(Number(h.goods[f].promo_limit_buy)+1==g){h.goods[f].price=h.goods[f].price/h.goods[f].promo_setting.dec_input;
}}if(g<h.goods[f].amount){if(Number(h.goods[f].promo_limit_buy)==g+1){h.goods[f].price=h.goods[f].price*h.goods[f].promo_setting.dec_input;}}}else{if(g>h.goods[f].amount){if(Number(h.goods[f].promo_limit_buy)+1==g){h.goods[f].price=h.goods[f].price-h.goods[f].promo_setting.dec_input;
}}if(g<h.goods[f].amount){if(Number(h.goods[f].promo_limit_buy)==g+1){h.goods[f].price=h.goods[f].price+h.goods[f].promo_setting.dec_input;}}}}console.info(h.goods[f].price);
var e=parseInt(g)-parseInt(h.goods[f].amount);var m=e*parseFloat(h.goods[f].price);var k=e*parseFloat(h.goods[f].box_fee);h.goods[f].amount=parseInt(g);
h.total_amount=parseInt(h.total_amount)+e;h.total_price=(parseFloat(h.total_price)+m).toFixed(2);h.total_box=(parseFloat(h.total_box)+k).toFixed(2);}}this.saveCart(h);
};b.prototype.delGood=function(g){var f=this.getCart();var h=[];for(var e=0,d=f.goods.length;e<d;e++){if(f.goods[e].sku_id==g){f.total_amount=parseInt(f.total_amount)-parseInt(f.goods[e].amount);
f.total_price=(parseFloat(f.total_price)-parseInt(f.goods[e].amount)*parseFloat(f.goods[e].price)).toFixed(2);f.total_box=(parseFloat(f.total_box)-parseInt(f.goods[e].amount)*parseFloat(f.goods[e].box_fee)).toFixed(2);
}else{h.push(f.goods[e]);}}f.goods=h;this.saveCart(f);};a.Cart=b;})(window,document);