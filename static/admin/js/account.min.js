$(function(){var a=$("#btn-login"),b=$("#btn-register"),c=$("#btn-findpassword");$("#get-register-code").on("click",function(d){d.preventDefault();getAuthCode($(this),$("#mobile").val(),"register");
});$("#get-findpassword-code").on("click",function(d){d.preventDefault();getAuthCode($(this),$("#mobile").val(),"update_pwd");});$("#login-form").bootstrapValidator({fields:{account:{validators:{notEmpty:{message:"帐号不能为空"}}},password:{validators:{notEmpty:{message:"密码不能为空"},stringLength:{min:6,max:25,message:"密码格式不正确"}}}}}).on("success.form.bv",function(g){g.preventDefault();
var f=$("#account").val(),d=$("#password").val();a.prop("disabled",true).text("登录中...");$.post(__BASEURL__+"passport_api/login",autoCsrf({account:f,password:d}),function(e){if(e.success){new Msg({type:"success",msg:"登录成功",delay:1});
window.location.href=__BASEURL__;}else{new Msg({type:"danger",msg:e.msg});}a.prop("disabled",false).text("登录");});});$("#register-form").bootstrapValidator({fields:{mobile:{validators:{notEmpty:{message:"手机号不能为空"},regexp:{regexp:PregRule.Tel,message:"手机号格式不正确"}}},code:{validators:{notEmpty:{message:"验证码不能为空"},regexp:{regexp:PregRule.Authcode,message:"输入6位验证码"}}},password:{validators:{notEmpty:{message:"密码不能为空"},regexp:{regexp:PregRule.Pwd,message:"请使用字母、数字和符号的密码组合，8-25个字符"}}},repassword:{validators:{notEmpty:{message:"密码不能为空"},identical:{field:"password",message:"两次密码不一致"}}}}}).on("success.form.bv",function(i){i.preventDefault();
var f=$("#mobile").val(),d=$("#password").val(),h=$("#repassword").val(),g=$("#code").val();b.prop("disabled",true).text("注册中...");$.post(__BASEURL__+"passport_api/register",autoCsrf({mobile:f,code:g,password:d,repassword:h}),function(e){if(e.success){new Msg({type:"success",msg:"注册成功",delay:1});
window.location.href=__BASEURL__+"passport/login";}else{new Msg({type:"danger",msg:e.msg});}b.prop("disabled",false).text("确定注册");});});$("#findpassword-form").bootstrapValidator({fields:{mobile:{validators:{notEmpty:{message:"手机号不能为空"},regexp:{regexp:PregRule.Tel,message:"手机号格式不正确"}}},code:{validators:{notEmpty:{message:"验证码不能为空"},regexp:{regexp:PregRule.Authcode,message:"输入6位验证码"}}},password:{validators:{notEmpty:{message:"密码不能为空"},regexp:{regexp:PregRule.Pwd,message:"请使用字母、数字和符号的密码组合，8-25个字符"}}},repassword:{validators:{notEmpty:{message:"密码不能为空"},identical:{field:"password",message:"两次密码不一致"}}}}}).on("success.form.bv",function(h){h.preventDefault();
var f=$("#mobile").val(),g=$("#code").val(),d=$("#password").val();c.prop("disabled",true).text("修改中...");$.post(__BASEURL__+"passport_api/findpassword",autoCsrf({mobile:f,password:d,repassword:d,code:g}),function(e){if(e.success){new Msg({type:"success",msg:"修改成功",delay:1});
window.location.href=__BASEURL__+"passport/login";}else{new Msg({type:"danger",msg:e.msg});}c.prop("disabled",false).text("确定修改");});});});