function needCLodop(){try{var t=navigator.userAgent;if(null!=t.match(/Windows\sPhone/i))return!0;if(null!=t.match(/iPhone|iPod/i))return!0;if(null!=t.match(/Android/i))return!0;if(null!=t.match(/Edge\D?\d+/i))return!0;var e=t.match(/Trident\D?\d+/i),a=t.match(/MSIE\D?\d+/i),o=t.match(/OPR\D?\d+/i),i=t.match(/Firefox\D?\d+/i),d=t.match(/x64/i);if(null==e&&null==a&&null!==d)return!0;if(null!==i){if(i=i[0].match(/\d+/),i[0]>=41||null!==d)return!0}else if(null!==o){if(o=o[0].match(/\d+/),o[0]>=32)return!0}else if(null==e&&null==a){var n=t.match(/Chrome\D?\d+/i);if(null!==n&&(n=n[0].match(/\d+/),n[0]>=41))return!0}return!1}catch(t){return!0}}function getLodop(t,e){var a,o='<div class="alert alert-danger" style="position: fixed; top: 10px;left: 20px; right: 20px;z-index: 999;padding: 12px 20px;">打印控件未安装!点击这里<a href=\'http://www.lodop.net/demolist/install_lodop32.zip\' target=\'_blank\'>执行安装</a>,安装后请刷新页面或重新进入。<button style="opacity: .8;color: #fff;" type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>',i='<div class="alert alert-danger" style="position: fixed; top: 10px;left: 20px; right: 20px;z-index: 999;padding: 12px 20px;">打印控件需要升级!点击这里<a href=\'http://www.lodop.net/demolist/install_lodop32.zip\' target=\'_blank\'>执行升级</a>,升级后请重新进入。<button style="opacity: .8;color: #fff;" type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>',d='<div class="alert alert-danger" style="position: fixed; top: 10px;left: 20px; right: 20px;z-index: 999;padding: 12px 20px;">打印控件未安装!点击这里<a href=\'http://www.lodop.net/demolist/install_lodop64.zip\' target=\'_blank\'>执行安装</a>,安装后请刷新页面或重新进入。<button style="opacity: .8;color: #fff;" type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>',n='<div class="alert alert-danger" style="position: fixed; top: 10px;left: 20px; right: 20px;z-index: 999;padding: 12px 20px;">打印控件需要升级!点击这里<a href=\'http://www.lodop.net/demolist/install_lodop64.zip\' target=\'_blank\'>执行升级</a>,升级后请重新进入。<button style="opacity: .8;color: #fff;" type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>',l='<div class="alert alert-danger" style="position: fixed; top: 10px;left: 20px; right: 20px;z-index: 999;padding: 12px 20px;">（注意：如曾安装过Lodop旧版附件npActiveXPLugin,请在【工具】->【附加组件】->【扩展】中先卸它）<button style="opacity: .8;color: #fff;" type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>',r='<div class="alert alert-danger" style="position: fixed; top: 10px;left: 20px; right: 20px;z-index: 999;padding: 12px 20px;">(如果此前正常，仅因浏览器升级或重安装而出问题，需重新执行以上安装）<button style="opacity: .8;color: #fff;" type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>',p='<div class="alert alert-danger" style="position: fixed; top: 10px;left: 20px; right: 20px;z-index: 999;padding: 12px 20px;">CLodop云打印服务(localhost本地)未安装启动!点击这里<a href=\'http://www.lodop.net/demolist/CLodop_Setup_for_Win32NT.zip\' target=\'_blank\'>执行安装</a>,安装后请刷新页面。<button style="opacity: .8;color: #fff;" type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>',s='<div class="alert alert-danger" style="position: fixed; top: 10px;left: 20px; right: 20px;z-index: 999;padding: 12px 20px;">CLodop云打印服务需升级!点击这里<a href=\'http://www.lodop.net/demolist/CLodop_Setup_for_Win32NT.zip\' target=\'_blank\'>执行升级</a>,升级后请刷新页面。<button style="opacity: .8;color: #fff;" type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button></div>';try{var c=navigator.userAgent.indexOf("MSIE")>=0||navigator.userAgent.indexOf("Trident")>=0;if(needCLodop()){try{a=getCLodop()}catch(t){}if(!a&&"complete"!==document.readyState)return void alert("C-Lodop没准备好，请稍后再试！");if(!a)return void(c?document.write(p):$("body").append(p));CLODOP.CVERSION<"3.0.2.8"&&(c?document.write(s):$("body").append(s)),e&&e.parentNode&&e.parentNode.removeChild(e),t&&t.parentNode&&t.parentNode.removeChild(t)}else{var u=c&&navigator.userAgent.indexOf("x64")>=0;if(void 0!=t||void 0!=e?a=c?t:e:null==CreatedOKLodop7766?(a=document.createElement("object"),a.setAttribute("width",0),a.setAttribute("height",0),a.setAttribute("style","position:absolute;left:0px;top:-100px;width:0px;height:0px;"),c?a.setAttribute("classid","clsid:2105C259-1E0C-4534-8141-A753534CB4CA"):a.setAttribute("type","application/x-print-lodop"),document.documentElement.appendChild(a),CreatedOKLodop7766=a):a=CreatedOKLodop7766,null==a||"undefined"==typeof a.VERSION)return navigator.userAgent.indexOf("Chrome")>=0&&$("body").append(r),navigator.userAgent.indexOf("Firefox")>=0&&$("body").append(l),u?document.write(d):c?document.write(o):$("body").append(o),a}return a.VERSION<"6.2.2.0"?(needCLodop()||(u?document.write(n):c?document.write(i):$("body").append(i)),a):(a.SET_LICENSES("","334CA3098803C01D4CC03384223901D4","C94CEE276DB2187AE6B65D56B3FC2848",""),a)}catch(t){alert("getLodop出错:"+t)}}var CreatedOKLodop7766=null;if(needCLodop()){var head=document.head||document.getElementsByTagName("head")[0]||document.documentElement,oscript=document.createElement("script");oscript.src="http://localhost:8000/CLodopfuncs.js?priority=1",head.insertBefore(oscript,head.firstChild),oscript=document.createElement("script"),oscript.src="http://localhost:18000/CLodopfuncs.js?priority=0",head.insertBefore(oscript,head.firstChild)}