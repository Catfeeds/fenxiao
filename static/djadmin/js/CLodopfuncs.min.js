function getCLodop(){return window.CLODOP2015_7028}(function(e){var t={strWebPageID:"0:0:032",strTaskID:"",strHostURI:"http://localhost:8000",VERSION:"6.2.2.0",IVERSION:"6220",CVERSION:"3.0.2.8",HTTPS_STATUS:0,VERSION_EXT:!1,iBaseTask:0,timeThreshold:5,Priority:0,blIslocal:!0,Iframes:[],ItemDatas:{},PageData:{},defStyleJson:{},PageDataEx:{},ItemCNameStyles:{},blWorking:!1,blNormalItemAdded:!1,blTmpSelectedIndex:null,Caption:null,Color:null,CompanyName:null,Border:null,Inbrowse:null,webskt:null,SocketEnable:!1,SocketOpened:!1,NoClearAfterPrint:!1,On_Return_Remain:!1,On_Return:null,Result:null,iTrySendTimes:0,blOneByone:!1,DelimChar:"\f\f",Printers:{default:"2",list:[{name:"Microsoft XPS Document Writer",DriverName:"Microsoft XPS Document Writer v4",PortName:"PORTPROMPT:",Orientation:"1",PaperSize:"122",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"15",PrintQuality:"600",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1539",DCOrientation:"270",MaxExtentWidth:"8636",MaxExtentLength:"11176",MinExtentWidth:"570",MinExtentlength:"900",pagelist:[{name:"信纸"},{name:"小号信纸"},{name:"Tabloid"},{name:"Ledger"},{name:"法律专用纸"},{name:"Statement"},{name:"Executive"},{name:"A3"},{name:"A4"},{name:"A4 小号"},{name:"A5"},{name:"B4 (JIS)"},{name:"B5 (JIS)"},{name:"Folio"},{name:"Quarto"},{name:"10x14"},{name:"11x17"},{name:"便笺"},{name:"信封 #9"},{name:"信封 #10"},{name:"信封 #11"},{name:"信封 #12"},{name:"信封 #14"},{name:"C size sheet"},{name:"D size sheet"},{name:"E size sheet"},{name:"信封 DL"},{name:"信封 C5"},{name:"信封 C3"},{name:"信封 C4"},{name:"信封 C6"},{name:"信封 C65"},{name:"信封 B4"},{name:"信封 B5"},{name:"信封 B6"},{name:"信封"},{name:"信封 Monarch"},{name:"6 3/4 信封"},{name:"美国标准 Fanfold"},{name:"德国标准 Fanfold"},{name:"德国法律专用纸 Fanfold"},{name:"B4 (ISO)"},{name:"日式明信片"},{name:"9x11"},{name:"10x11"},{name:"15x11"},{name:"信封邀请函"},{name:"特大信纸"},{name:"特大法律专用纸"},{name:"A4 特大"},{name:"信纸横向"},{name:"A4 横向"},{name:"特大信纸横向"},{name:"Super A"},{name:"Super B"},{name:"信纸加大"},{name:"A4 加大"},{name:"A5 横向"},{name:"B5 (JIS) 横向"},{name:"A3 特大"},{name:"A5 特大"},{name:"B5 (ISO) 特大"},{name:"A2"},{name:"A3 横向"},{name:"A3 特大横向"},{name:"日式往返明信片"},{name:"A6"},{name:"日式信封 Kaku #2"},{name:"日式信封 Kaku #3"},{name:"日式信封 Chou #3"},{name:"日式信封 Chou #4"},{name:"信纸旋转"},{name:"A3 旋转"},{name:"A4 旋转"},{name:"A5 旋转"},{name:"B4 (JIS) 旋转"},{name:"B5 (JIS) 旋转"},{name:"日式明信片旋转"},{name:"双层日式明信片旋转"},{name:"A6 旋转"},{name:"日式信封 Kaku #2 旋转"},{name:"日式信封 Kaku #3 旋转"},{name:"日式信封 Chou #3 旋转"},{name:"日式信封 Chou #4 旋转"},{name:"B6 (JIS)"},{name:"B6 (JIS) 旋转"},{name:"12x11"},{name:"日式信封 You #4"},{name:"日式信封 You #4 旋转"},{name:"PRC 信封 #1"},{name:"PRC 信封 #3"},{name:"PRC 信封 #4"},{name:"PRC 信封 #5"},{name:"PRC 信封 #6"},{name:"PRC 信封 #7"},{name:"PRC 信封 #8"},{name:"PRC 信封 #9"},{name:"PRC 信封 #10"},{name:"PRC 信封 #1 旋转"},{name:"PRC 信封 #3 旋转"},{name:"PRC 信封 #4 旋转"},{name:"PRC 信封 #5 旋转"},{name:"PRC 信封 #6 旋转"},{name:"PRC 信封 #7 旋转"},{name:"PRC 信封 #8 旋转"},{name:"PRC 信封 #9 旋转"},{name:"LodopCustomPage"},{name:"用户定义大小"}]},{name:"Microsoft Print to PDF",DriverName:"Microsoft Print To PDF",PortName:"PORTPROMPT:",Orientation:"1",PaperSize:"9",PaperLength:"2970",PaperWidth:"2100",Copies:"1",DefaultSource:"15",PrintQuality:"600",Color:"2",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1539",DCOrientation:"90",MaxExtentWidth:"2970",MaxExtentLength:"4318",MinExtentWidth:"1397",MinExtentlength:"2100",pagelist:[{name:"信纸"},{name:"Tabloid"},{name:"法律专用纸"},{name:"Statement"},{name:"Executive"},{name:"A3"},{name:"A4"},{name:"A5"},{name:"B4 (JIS)"},{name:"B5 (JIS)"}]},{name:"Gprinter  GP-2120TL",DriverName:"Gprinter  GP-2120TL",PortName:"USB001",Orientation:"1",PaperSize:"256",PaperLength:"600",PaperWidth:"900",Copies:"1",DefaultSource:"4",PrintQuality:"203",Color:"1",Duplex:"1",FormName:"User defined",Comment:"",DriverVersion:"1024",DCOrientation:"90",MaxExtentWidth:"900",MaxExtentLength:"28140",MinExtentWidth:"10",MinExtentlength:"10",pagelist:[{name:"User defined"}]},{name:"Fax",DriverName:"Microsoft Shared Fax Driver",PortName:"SHRFAX:",Orientation:"1",PaperSize:"9",PaperLength:"0",PaperWidth:"0",Copies:"0",DefaultSource:"1",PrintQuality:"200",Color:"1",Duplex:"1",FormName:"A4",Comment:"",DriverVersion:"1024",DCOrientation:"90",MaxExtentWidth:"2160",MaxExtentLength:"3556",MinExtentWidth:"0",MinExtentlength:"0",pagelist:[{name:"信纸"},{name:"小号信纸"},{name:"法律专用纸"},{name:"Statement"},{name:"Executive"},{name:"A4"},{name:"A4 小号"},{name:"A5"},{name:"B5 (JIS)"},{name:"Folio"},{name:"Quarto"},{name:"便笺"},{name:"信封 #9"},{name:"信封 #10"},{name:"信封 #11"},{name:"信封 #12"},{name:"信封 #14"},{name:"信封 DL"},{name:"信封 C5"},{name:"信封 C6"},{name:"信封 C65"},{name:"信封 B5"},{name:"信封 B6"},{name:"信封"},{name:"信封 Monarch"},{name:"6 3/4 信封"},{name:"德国标准 Fanfold"},{name:"德国法律专用纸 Fanfold"},{name:"日式明信片"},{name:"Reserved48"},{name:"Reserved49"},{name:"信纸横向"},{name:"A4 横向"},{name:"信纸加大"},{name:"A4 加大"},{name:"A5 横向"},{name:"B5 (JIS) 横向"},{name:"A5 特大"},{name:"B5 (ISO) 特大"},{name:"日式往返明信片"},{name:"A6"},{name:"日式信封 Kaku #3"},{name:"日式信封 Chou #3"},{name:"日式信封 Chou #4"},{name:"A5 旋转"},{name:"日式明信片旋转"},{name:"双层日式明信片旋转"},{name:"A6 旋转"},{name:"日式信封 Chou #4 旋转"},{name:"B6 (JIS)"},{name:"B6 (JIS) 旋转"},{name:"日式信封 You #4"},{name:"PRC 16K"},{name:"PRC 32K"},{name:"PRC 32K(Big)"},{name:"PRC 信封 #1"},{name:"PRC 信封 #2"},{name:"PRC 信封 #3"},{name:"PRC 信封 #4"},{name:"PRC 信封 #5"},{name:"PRC 信封 #6"},{name:"PRC 信封 #7"},{name:"PRC 信封 #8"},{name:"PRC 32K 旋转"},{name:"PRC 32K(大)旋转"},{name:"PRC 信封 #1 旋转"},{name:"PRC 信封 #2 旋转"},{name:"PRC 信封 #3 旋转"},{name:"PRC 信封 #4 旋转"},{name:"102 x 152 mm (4 x 6 in)"},{name:"89 x 127 mm (3.5 x 5 in)"},{name:"Postcard 100 x 148 mm"},{name:"LodopCustomPage"},{name:"Gprinter 58(48) x 210 mm"},{name:"Gprinter 58(48) x 297 mm"},{name:"40 x 30"},{name:"40 x 50"},{name:"50 x 20"},{name:"50 x 30"},{name:"50 x 40"},{name:"60 x 30"},{name:"60 x 40"},{name:"70 x 30"},{name:"70 x 40"},{name:"70 x 50"},{name:"80 x 30"},{name:"80 x 40"},{name:"80 x 50"},{name:"100 x 25"},{name:"100 x 30"},{name:"100 x 40"},{name:"100 x 50"},{name:"100 x 60"},{name:"100 x 75"},{name:"E-POST 100 x 100"},{name:"JD Express 100 x 113"},{name:"YTO Express 100 x 149"},{name:"SF Express 100 x 150"},{name:"BEST Express 100 x 170"},{name:"TT Express 100 x 180"},{name:"ZTO Standard 100 x 190"},{name:"STO Standard 100 x 201"},{name:"Yunda Standard 100 x 203"},{name:"SF EXT. 100 x 250"},{name:"YTO/STO EXT. 100 x 280"},{name:"ZTO EXT. 100 x 290"},{name:"Standard 108 x 105"}]}]},altMessageWebSocketInvalid:"WebSocket没准备好，点确定继续...",altMessageNoReadWriteFile:"不能远程读写文件!",altMessageNoReadFile:"不能远程读文件!",altMessageNoWriteFile:"不能远程写文件!",altMessageNoPrintDesign:"不能远程打印设计!",altMessageNoPrintSetup:"不能远程打印维护!",altMessageSomeWindowExist:"有窗口已打开，先关闭它(持续如此时请刷新页面)!",altMessageBusy:"上一个请求正忙，请稍后再试！",Browser:function(){var e=navigator.userAgent,t="[object Opera]"==Object.prototype.toString.call(window.opera);return{IE:!!window.attachEvent&&!t,Opera:t,WebKit:e.indexOf("AppleWebKit/")>-1,Gecko:e.indexOf("Gecko")>-1&&e.indexOf("KHTML")===-1,MobileSafari:/Apple.*Mobile/.test(e)}}(),GetTaskID:function(){if(!this.strTaskID||""==this.strTaskID){var e=new Date;this.iBaseTask++,this.strTaskID=""+e.getHours()+e.getMinutes()+e.getSeconds()+"_"+this.iBaseTask}return this.strWebPageID+this.strTaskID},DoInit:function(){this.strTaskID="",this.NoClearAfterPrint||(this.ItemDatas={count:0},this.PageData={},this.ItemCNameStyles={},this.defStyleJson={beginpage:0,beginpagea:0},this.blNormalItemAdded=!1)},OpenWebSocket:function(){if(!window.WebSocket&&!window.MozWebSocket)return void(window.On_CLodop_Opened&&t.Priority==window.CLODOP_OK_Priority&&setTimeout("window.On_CLodop_Opened(CLODOP)",1));this.SocketEnable=!0;try{this.webskt&&3!=this.webskt.readyState||(!window.WebSocket&&window.MozWebSocket&&(window.WebSocket=window.MozWebSocket),this.webskt=new WebSocket("ws://127.0.0.1:8000/c_webskt/"),this.webskt.onopen=function(e){t.SocketOpened=!0,window.On_CLodop_Opened&&t.Priority==window.CLODOP_OK_Priority&&setTimeout(window.On_CLodop_Opened(t),1)},this.webskt.onmessage=function(e){t.blOneByone=!1;var n=e.data;t.Result=n;try{var i=n.indexOf("="),a=null;if(i>=0&&i<30&&(a=n.slice(0,i),n=n.slice(i+1)),a.indexOf("ErrorMS")>-1)return void alert(n);if(t.On_Return){var s=t.On_Return;"true"==n||"false"==n?t.On_Return(a,"true"==n):t.On_Return(a,n),t.On_Return_Remain||s!==t.On_Return||(t.On_Return=null)}}catch(e){}},this.webskt.onclose=function(e){return t.SocketOpened?void setTimeout(t.OpenWebSocket(),2e3):void(t.SocketEnable=!1)},this.webskt.onerror=function(e){})}catch(e){this.webskt=null,setTimeout(t.OpenWebSocket(),2e3)}},wsSend:function(e){if(this.SocketEnable)return this.webskt&&1==this.webskt.readyState?(this.Result=null,this.iTrySendTimes=0,this.webskt.send(e),!0):(alert(this.altMessageWebSocketInvalid),this.iTrySendTimes++,this.iTrySendTimes<=1?setTimeout(t.wsSend(e),500):this.OpenWebSocket(),void 0)},FORMAT:function(e,n){if(this.blWorking)return alert(this.altMessageBusy),null;var i=null;if(void 0!==e&&void 0!==n){if(0==e.replace(/^\s+|\s+$/g,"").toLowerCase().indexOf("time:")){e=e.replace(/^\s+|\s+$/g,"").slice(5),n.toLowerCase().indexOf("now")>-1&&(n=(new Date).toString()),n.toLowerCase().indexOf("date")>-1&&(n=(new Date).toString()),n.toLowerCase().indexOf("time")>-1&&(n=(new Date).toString());var a="ymd";n.toLowerCase().indexOf("ymd")>-1&&(a="ymd",n=n.slice(3)),n.toLowerCase().indexOf("dmy")>-1&&(a="dmy",n=n.slice(3)),n.toLowerCase().indexOf("mdy")>-1&&(a="mdy",n=n.slice(3)),n=n.replace(/ [^ ]*\+[^ ]* /g," "),n=n.replace(/\(.*\)/g," "),n=n.replace(/星期日|星期一|星期二|星期三|星期四|星期五|星期六/g," "),n=n.replace(/[A-Za-z]+day|Mon|Tue|Wed|Thu|Fri|Sat|Sun/g," ");var s=0,r=new RegExp("Oct[A-Za-z]*|十月|10月","i");null!==n.match(r)&&(s=10,n=n.replace(r,"")),r=new RegExp("Nov[A-Za-z]*|十一月|11月","i"),null!==n.match(r)&&(s=11,n=n.replace(r,"")),r=new RegExp("Dec[A-Za-z]*|十二月|12月","i"),null!==n.match(r)&&(s=12,n=n.replace(r,"")),r=new RegExp("Jan[A-Za-z]*|一月|01月|1月","i"),null!==n.match(r)&&(s=1,n=n.replace(r,"")),r=new RegExp("Feb[A-Za-z]*|二月|02月|2月","i"),null!==n.match(r)&&(s=2,n=n.replace(r,"")),r=new RegExp("Mar[A-Za-z]*|三月|03月|3月","i"),null!==n.match(r)&&(s=3,n=n.replace(r,"")),r=new RegExp("Apr[A-Za-z]*|四月|04月|4月","i"),null!==n.match(r)&&(s=4,n=n.replace(r,"")),r=new RegExp("May[A-Za-z]*|五月|05月|5月","i"),null!==n.match(r)&&(s=5,n=n.replace(r,"")),r=new RegExp("Jun[A-Za-z]*|六月|06月|6月","i"),null!==n.match(r)&&(s=6,n=n.replace(r,"")),r=new RegExp("Jul[A-Za-z]*|七月|07月|7月","i"),null!==n.match(r)&&(s=7,n=n.replace(r,"")),r=new RegExp("Aug[A-Za-z]*|八月|08月|8月","i"),null!==n.match(r)&&(s=8,n=n.replace(r,"")),r=new RegExp("Sep[A-Za-z]*|九月|09月|9月","i"),null!==n.match(r)&&(s=9,n=n.replace(r,"")),n=n.replace(/日|秒/g," "),n=n.replace(/时|分/g,":");var o=n.match(/ \d+:\d+:\d+/);null==o&&(o=""),n=n.replace(/ \d+:\d+:\d+/,"")+o;var l=new Date,h=0,u=0,d=0,m=0,p=0,c=0,f=n,g="",D=0;MC2=0,MC3=0,g=f.match(/\d+/),null!==g&&(D=parseInt(g[0]),f=f.replace(/\d+/,"")),g=f.match(/\d+/),null!==g&&(MC2=parseInt(g[0]),f=f.replace(/\d+/,"")),s<=0&&(g=f.match(/\d+/),null!==g&&(MC3=parseInt(g[0]),f=f.replace(/\d+/,""))),s>0?(u=s,MC2<=31?(h=D,d=MC2):(h=MC2,d=D)):"dmy"==a?(d=D,u=MC2,h=MC3):"mdy"==a?(u=D,d=MC2,h=MC3):(h=D,u=MC2,d=MC3,MC3>31?(h=MC3,u=D,d=MC2,D>12&&(d=D,u=MC2)):MC2>12&&(h=MC2,u=D));var g=f.match(/\d+/);null!==g&&(m=parseInt(g[0]),f=f.replace(/\d+/,""));var g=f.match(/\d+/);null!==g&&(p=parseInt(g[0]),f=f.replace(/\d+/,""));var g=f.match(/\d+/);if(null!==g&&(c=parseInt(g[0]),f=f.replace(/\d+/,"")),"isvalidformat"==e.toLowerCase())n=h>0&&u>0&&u<=12&&d>0&&d<=31;else{(""+h).length<4&&(h+=2e3),l.setFullYear(h,u-1,d),l.setHours(m),l.setMinutes(p),l.setSeconds(c);var P=l.getDay();if("weekindex"==e.toLowerCase())n=P;else if("floatvalue"==e.toLowerCase())n=l.getTime();else{var v="";switch(P){case 0:v="日";break;case 1:v="一";break;case 2:v="二";break;case 3:v="三";break;case 4:v="四";break;case 5:v="五";break;case 6:v="六"}if(n=e.replace(/dddd/gi,"星期"+v),/(y+)/i.test(n)&&(n=n.replace(RegExp.$1,(h+"").substr(4-RegExp.$1.length))),/(m+:)/i.test(n)&&(n=n.replace(RegExp.$1,("00"+p+":").substr(("00"+p+":").length-RegExp.$1.length))),/(M+)/i.test(n)){var _=(""+u).length>RegExp.$1.length?(""+u).length:RegExp.$1.length;n=n.replace(RegExp.$1,("00"+u).substr(("00"+u).length-_))}if(/(d+)/i.test(n)){var _=(""+d).length>RegExp.$1.length?(""+d).length:RegExp.$1.length;n=n.replace(RegExp.$1,("00"+d).substr(("00"+d).length-_))}/(H+)/i.test(n)&&(n=n.replace(RegExp.$1,("00"+m).substr(("00"+m).length-RegExp.$1.length))),/(n+)/i.test(n)&&(n=n.replace(RegExp.$1,("00"+p).substr(("00"+p).length-RegExp.$1.length))),/(s+)/i.test(n)&&(n=n.replace(RegExp.$1,("00"+c).substr(("00"+c).length-RegExp.$1.length)))}}if(t.On_Return){var T=t.On_Return;t.On_Return(0,n),t.On_Return_Remain||T!==t.On_Return||(t.On_Return=null)}return n}this.blIslocal||e.indexOf("FILE:")<0?(this.PageData.format_type=e,this.PageData.format_value=n,1==this.DoPostDatas("format")&&(this.GetLastResult(!1),i=this.GetTaskID())):alert(this.altMessageNoReadWriteFile)}return this.DoInit(),this.blWorking=!1,i},SET_PRINT_PAPER:function(e,t,n,i,a){return this.PRINT_INITA(e,t,n,i,a)},PRINT_INIT:function(e){return this.PRINT_INITA(null,null,null,null,e)},PRINT_INITA:function(e,t,n,i,a){return void 0!==e&&null!==e||(e=""),void 0!==t&&null!==t||(t=""),void 0!==n&&null!==n||(n=""),void 0!==i&&null!==i||(i=""),void 0!==a&&null!==a||(a=""),this.NoClearAfterPrint=!1,this.DoInit(),this.PageData.top=e,this.PageData.left=t,this.PageData.width=n,this.PageData.height=i,this.PageData.printtask=a,!0},SET_PRINT_MODE:function(e,t){if(void 0!==e&&null!==e||(e=""),void 0!==t&&null!==t||(t=""),""===e)return!1;if(e=e.toLowerCase(),this.PageData[e]=t,"noclear_after_print"==e&&(this.NoClearAfterPrint=t),e.indexOf("window_def")>-1||e.indexOf("control_printer")>-1){var n=null;return 1==this.DoPostDatas("onlysetprint")&&(this.GetLastResult(!1),n=this.GetTaskID()),this.DoInit(),this.blWorking=!1,n}},ADD_PRINT_TEXT:function(e,t,n,i,a){return this.AddItemArray(2,e,t,n,i,a)},ADD_PRINT_TEXTA:function(e,t,n,i,a,s){return this.AddItemArray(2,t,n,i,a,s,e)},ADD_PRINT_HTM:function(e,t,n,i,a){return this.AddItemArray(4,e,t,n,i,a)},ADD_PRINT_HTML:function(e,t,n,i,a){return this.AddItemArray(1,e,t,n,i,a)},ADD_PRINT_HTMLA:function(e,t,n,i,a,s){return this.AddItemArray(1,t,n,i,a,s,e)},ADD_PRINT_BARCODE:function(e,t,n,i,a,s){return this.AddItemArray(9,e,t,n,i,s,null,null,null,null,null,null,a)},ADD_PRINT_BARCODEA:function(e,t,n,i,a,s,r){return this.AddItemArray(9,t,n,i,a,r,e,null,null,null,null,null,s)},ADD_PRINT_RECTA:function(e,t,n,i,a,s,r){return this.AddItemArray(3,e,t,n,i,null,null,2,a,s,r,null)},ADD_PRINT_RECT:function(e,t,n,i,a,s){return this.AddItemArray(3,e,t,n,i,null,null,2,a,s,null,null)},ADD_PRINT_ELLIPSEA:function(e,t,n,i,a,s,r){return this.AddItemArray(3,e,t,n,i,null,null,3,a,s,r,null)},ADD_PRINT_ELLIPSE:function(e,t,n,i,a,s){return this.AddItemArray(3,e,t,n,i,null,null,3,a,s,null,null)},ADD_PRINT_SHAPE:function(e,t,n,i,a,s,r,o){return this.AddItemArray(3,t,n,i,a,null,null,e,s,r,o,null)},ADD_PRINT_LINE:function(e,t,n,i,a,s){return this.AddItemArray(3,e,t,n,i,null,null,0,a,s,null,"1")},ADD_PRINT_DNLINE:function(e,t,n,i,a,s){return this.AddItemArray(3,e,t,n,i,null,null,1,a,s,null,null)},ADD_PRINT_DNLINEA:function(e,t,n,i,a,s,r){return this.AddItemArray(3,e,t,n,i,null,null,1,a,s,r,null)},ADD_PRINT_UPLINE:function(e,t,n,i,a,s){return this.AddItemArray(3,e,t,n,i,null,null,0,a,s,null,null)},ADD_PRINT_UPLINEA:function(e,t,n,i,a,s,r){return this.AddItemArray(3,e,t,n,i,null,null,0,a,s,r,null)},ADD_PRINT_TABLE:function(e,t,n,i,a){return this.AddItemArray(6,e,t,n,i,a)},ADD_PRINT_TBURL:function(e,t,n,i,a){return this.AddItemArray(7,e,t,n,i,a)},ADD_PRINT_URL:function(e,t,n,i,a){return this.AddItemArray(5,e,t,n,i,a)},ADD_PRINT_IMAGE:function(e,t,n,i,a){return this.AddItemArray(8,e,t,n,i,a)},ADD_PRINT_CHART:function(e,t,n,i,a,s){return this.AddItemArray(10,e,t,n,i,s,null,null,null,null,null,null,null,a)},SET_PRINT_PROPERTY:function(e,t,n,i){this.SET_PRINT_STYLEA(e,"ItemType",t),this.SET_PRINT_STYLEA(e,"HOrient",n),this.SET_PRINT_STYLEA(e,"VOrient",i)},SET_PRINT_PROPERTYA:function(e,t,n,i){this.SET_PRINT_PROPERTY(e,t,n,i)},SET_PRINT_STYLE:function(e,t){return void 0!==e&&null!==e||(e=""),void 0!==t&&null!==t||(t=""),""!==e&&(e=e.toLowerCase(),void(this.defStyleJson[e]=t))},SET_PRINT_STYLEA:function(e,t,n){if(void 0!==e&&null!==e||(e=""),void 0!==t&&null!==t||(t=""),void 0!==n&&null!==n||(n=""),""===e||""===t)return!1;if(this.ItemDatas.count<=0)return void 0!==this.PageData.add_print_program_data&&(this.ItemCNameStyles[t.toLowerCase()+"-"+e]=n,!0);if(t=t.toLowerCase(),"type"==t)return!1;var i=!1;0==e&&(e=this.ItemDatas.count);for(var a in this.ItemDatas){var s=this.ItemDatas[a].itemname;(e==a||e==s||"string"==typeof e&&"string"==typeof s&&e.toUpperCase()==s.toUpperCase())&&(this.ItemDatas[a][t]=n,i=!0)}return!!i},SET_PRINT_TEXT_STYLE:function(e,t,n,i,a,s,r){this.SET_PRINT_STYLEA(e,"fontname",t),this.SET_PRINT_STYLEA(e,"fontsize",n),this.SET_PRINT_STYLEA(e,"bold",i),this.SET_PRINT_STYLEA(e,"italic",a),this.SET_PRINT_STYLEA(e,"underline",s),this.SET_PRINT_STYLEA(e,"alignment",r)},SET_PRINT_TEXT_STYLEA:function(e,t,n,i,a,s,r,o){this.SET_PRINT_TEXT_STYLE(e,t,n,i,a,s,r),this.SET_PRINT_STYLEA(e,"fontcolor",o)},SET_PRINT_TEXT_STYLEB:function(e,t,n,i,a,s,r,o){this.SET_PRINT_TEXT_STYLEA(e,t,n,i,a,s,r,o)},NEWPAGE:function(){this.NewPage()},NewPage:function(){var e,t=!1;for(var n in this.ItemDatas){e="count"!=n;for(var i in this.ItemDatas[n])if("itemtype"==i&&(e=!1,0==this.ItemDatas[n][i]||4==this.ItemDatas[n][i])){t=!0;break}if(e&&(t=!0),t)break}t&&(this.defStyleJson.beginpage=this.defStyleJson.beginpage+1)},NEWPAGEA:function(){this.NewPageA()},NewPageA:function(){var e,t=!1;for(var n in this.ItemDatas){e="count"!=n;for(var i in this.ItemDatas[n])if("itemtype"==i&&(e=!1,0==this.ItemDatas[n][i]||4==this.ItemDatas[n][i])){t=!0;break}if(e&&(t=!0),t)break}t&&(this.defStyleJson.beginpagea=this.defStyleJson.beginpagea+1)},PREVIEW:function(e,t,n){if(this.blWorking)return alert(this.altMessageBusy),null;var i=null;return!e&&this.blIslocal?1==this.DoPostDatas("preview")&&(this.Result=null,this.GetLastResult(!0),i=this.GetTaskID()):1==this.DoPostDatas("cpreview")&&(this.DoCPreview(e,t,n),i=this.GetTaskID()),this.DoInit(),this.blWorking=!1,i},PRINT:function(e,t,n){if(this.blWorking)return alert(this.altMessageBusy),null;var i=null;return 1==this.DoPostDatas("print")&&(i=this.GetTaskID()),this.DoInit(),this.blWorking=!1,i},GET_PRINTER_COUNT:function(){return void 0===this.Printers?0:this.Printers.list.length},GET_PRINTER_NAME:function(e){if(void 0===this.Printers)return"";if("string"==typeof e&&e.indexOf(":")>-1){var t=e.slice(e.indexOf(":")+1);return e=e.slice(0,e.indexOf(":")),e==-1?this.Printers.list[this.Printers.default][t]:this.Printers.list[e][t]}return e==-1?this.Printers.list[this.Printers.default].name:e>=0&&e<this.Printers.list.length?this.Printers.list[e].name:"Printer NO. overflow"},GET_PAGESIZES_LIST:function(e,t,n,i){if(n||(n="pagelist"),i||(i="name"),void 0===this.Printers)return"";e==-1&&(e=this.Printers.list[this.Printers.default].name);for(var a in this.Printers.list)if(e==a||e==this.Printers.list[a].name){var s="";for(var r in this.Printers.list[a][n])s="id"==i&&this.Printers.list[a][n][r].id?""===s?this.Printers.list[a][n][r].id:s+t+this.Printers.list[a][n][r].id:""===s?this.Printers.list[a][n][r].name:s+t+this.Printers.list[a][n][r].name;return s}return""},SET_PRINTER_INDEX:function(e,t){if(void 0===this.Printers)return!1;t||(t="printerindex"),e+="",e=e.replace(/^\s+|\s+$|\\/g,"");var n=e.indexOf(","),i=e;if(n>-1&&(i=e.slice(0,n)),"-1"==i)return this.PageData[t]=this.Printers.default,n>-1&&(this.PageData.printersubid=e.slice(n+1)),!0;for(var a in this.Printers.list){var s=this.Printers.list[a].name.replace(/\\/g,"");if(s==i||a==i)return this.PageData[t]=a,n>-1&&(this.PageData.printersubid=e.slice(n+1)),!0}return!1},SET_PRINTER_INDEXA:function(e){return this.SET_PRINTER_INDEX(e,"printerindexa")},PRINT_DESIGN:function(){if(this.blWorking)return alert(this.altMessageBusy),null;var e=null;return this.blIslocal?1==this.DoPostDatas("print_design")&&(this.Result=null,this.GetLastResult(!0),e=this.GetTaskID()):alert(this.altMessageNoPrintDesign),this.DoInit(),this.blWorking=!1,e},PRINT_SETUP:function(){if(this.blWorking)return alert(this.altMessageBusy),null;var e=null;return this.blIslocal?1==this.DoPostDatas("print_setup")&&(this.Result=null,this.GetLastResult(!0),e=this.GetTaskID()):alert(this.altMessageNoPrintSetup),this.DoInit(),this.blWorking=!1,e},SET_PRINT_PAGESIZE:function(e,t,n,i){void 0!==e&&null!==e&&(this.PageData.orient=e),void 0!==t&&null!==t&&(this.PageData.pagewidth=t),void 0!==n&&null!==n&&(this.PageData.pageheight=n),void 0!==i&&null!==i&&(this.PageData.pagename=i)},SET_PRINT_COPIES:function(e){if(void 0!==e&&null!==e)return this.PageData.printcopies=e,!0},SELECT_PRINTER:function(e){return this.SelectBox.create(388,240,!e),!0},PRINTA:function(e,t){if(this.blWorking)return alert(this.altMessageBusy),null;var n=null;return!t&&this.blIslocal?(this.Result=null,e?1==this.DoPostDatas("printb")&&(this.GetLastResult(!1),n=this.GetTaskID()):1==this.DoPostDatas("printa")&&(this.GetLastResult(!0),n=this.GetTaskID()),this.DoInit(),this.blWorking=!1):this.SELECT_PRINTER(!0),n},PRINTAOK:function(e,n,i,a,s){if(this.SET_PRINTER_INDEX(e),this.SET_PRINT_COPIES(n),void 0!==i&&0!==i&&this.SET_PRINT_MODE("PRINT_START_PAGE",i),void 0!==a&&0!==a&&this.SET_PRINT_MODE("PRINT_END_PAGE",a),s){if(this.blTmpSelectedIndex=e,t.On_Return){var r=t.On_Return;t.On_Return(0,e),t.On_Return_Remain||r!==t.On_Return||(t.On_Return=null)}}else this.PRINT()},SET_LICENSES:function(e,t,n,i){"THIRD LICENSE"==e&&""==t?(n&&""!==n&&(this.PageDataEx.licensec=n),i&&""!==i&&(this.PageDataEx.licensed=i)):"LICENSE TETCODE"==e&&""==t&&""==i?n&&""!==n&&(this.PageDataEx.Licensetetcode=n):(e&&""!==e&&(this.PageDataEx.companyname=e),t&&""!==t&&(this.PageDataEx.license=t),n&&""!==n&&(this.PageDataEx.licensea=n),i&&""!==i&&(this.PageDataEx.licenseb=i))},PRINTB:function(){return this.PRINTA(!0)},PREVIEWA:function(){return this.PREVIEW()},PREVIEWB:function(){return this.PREVIEW()},ADD_PRINT_SETUP_BKIMG:function(e){if(void 0!==e&&null!==e)return this.PageData.setup_bkimg=e,!0},SET_PREVIEW_WINDOW:function(e,t,n,i,a,s){void 0!==e&&null!==e&&(this.PageData.pvw_dispmode=e),void 0!==t&&null!==t&&(this.PageData.pvw_toolmode=t),void 0!==n&&null!==n&&(this.PageData.pvw_directprint=n),void 0!==i&&null!==i&&(this.PageData.pvw_width=i),void 0!==a&&null!==a&&(this.PageData.pvw_height=a),void 0!==s&&null!==s&&(this.PageData.pvw_puttoncaptoin=s)},SET_PREVIEW_MODE:function(e){void 0!==e&&(this.PageData.pvw_preview_mode=e)},SET_SHOW_MODE:function(e,t){return void 0!==e&&null!==e||(e=""),void 0!==t&&null!==t||(t=""),""!==e&&(e=e.toLowerCase(),void(this.PageData["shwmod_"+e]=t))},SAVE_TO_FILE:function(e){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return this.blIslocal?e&&(this.PageData.stf_file_name=e,1==this.DoPostDatas("savetofile")&&(this.GetLastResult(!1),t=this.GetTaskID())):alert(this.altMessageNoWriteFile),this.DoInit(),this.blWorking=!1,t},SET_SAVE_MODE:function(e,t){return void 0!==e&&null!==e||(e=""),void 0!==t&&null!==t||(t=""),""!==e&&(e=e.toLowerCase(),void(this.PageData["stfmod_"+e]=t))},SEND_PRINT_RAWDATA:function(e){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return void 0!==e&&(this.PageData.raw_print_data=e,1==this.DoPostDatas("sendrawdata")&&(this.GetLastResult(!1),t=this.GetTaskID())),this.DoInit(),this.blWorking=!1,t},WRITE_FILE_TEXT:function(e,t,n){if(this.blWorking)return alert(this.altMessageBusy),null;var i=null;return this.blIslocal?void 0!==t&&void 0!==n&&(this.PageData.write_file_mode=e,this.PageData.write_file_name=t,this.PageData.write_file_text=n,1==this.DoPostDatas("writefiletext")&&(this.GetLastResult(!1),i=this.GetTaskID())):alert(this.altMessageNoWriteFile),this.DoInit(),this.blWorking=!1,i},GET_DIALOG_VALUE:function(e,t){if(this.blWorking)return alert(this.altMessageBusy),null;var n=null;return void 0!==e&&void 0!==t&&(this.blIslocal?(this.PageData.dialog_type=e,this.PageData.dialog_value=t,1==this.DoPostDatas("dialog")&&(this.GetLastResult(!0),n=this.GetTaskID())):alert(this.altMessageNoReadWriteFile)),this.DoInit(),this.blWorking=!1,n},WRITE_PORT_DATA:function(e,t){if(this.blWorking)return alert(this.altMessageBusy),null;var n=null;return void 0!==e&&void 0!==t&&(this.PageData.write_port_name=e,this.PageData.write_port_data=t,1==this.DoPostDatas("writeportdata")&&(this.GetLastResult(!1),n=this.GetTaskID())),this.DoInit(),this.blWorking=!1,n},READ_PORT_DATA:function(e){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return void 0!==e&&(this.PageData.read_port_name=e,1==this.DoPostDatas("readportdata")&&(this.GetLastResult(!1),t=this.GetTaskID())),this.DoInit(),this.blWorking=!1,t},GET_SYSTEM_INFO:function(e){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return void 0!==e&&(this.PageData.system_info_type=e,1==this.DoPostDatas("getsysteminfo")&&(this.GetLastResult(!1),t=this.GetTaskID())),this.DoInit(),this.blWorking=!1,t},GET_FILE_TEXT:function(e){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return this.blIslocal?void 0!==e&&(this.PageData.get_file_name=e,1==this.DoPostDatas("getfiletext")&&(this.GetLastResult(!1),t=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,t},IS_FILE_EXIST:function(e){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return this.blIslocal?void 0!==e&&(this.PageData.file_exist_name=e,1==this.DoPostDatas("isfileexist")&&(this.GetLastResult(!1),t=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,t},GET_FILE_TIME:function(e){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return this.blIslocal?void 0!==e&&(this.PageData.file_time_name=e,1==this.DoPostDatas("getfiletime")&&(this.GetLastResult(!1),t=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,t},GET_PRINT_INIFFNAME:function(e){if(this.blWorking)return alert(this.altMessageBusy),null;var t=null;return this.blIslocal?void 0!==e&&(this.PageData.iniff_task_name=e,1==this.DoPostDatas("getiniffname")&&(this.GetLastResult(!1),t=this.GetTaskID())):alert(this.altMessageNoReadFile),this.DoInit(),this.blWorking=!1,t},GET_VALUE:function(e,t){if(this.blWorking)return alert(this.altMessageBusy),null;var n=null;return void 0!==e&&void 0!==t&&(this.PageData.get_value_type=e,this.PageData.get_value_index=t,1==this.DoPostDatas("dogetvalue")&&(this.GetLastResult(!1),n=this.GetTaskID())),this.DoInit(),this.blWorking=!1,n},ADD_PRINT_DATA:function(e,t){if(void 0!==e&&null!==t&&e.toLowerCase().indexOf("programdata")>-1)return this.PageData.add_print_program_data=t,!0},SHOW_CHART:function(){},DO_ACTION:function(e,t){if(this.blWorking)return alert(this.altMessageBusy),null;var n=null;return void 0!==e&&void 0!==t&&(this.PageData.do_action_name=e,this.PageData.do_action_value=t,1==this.DoPostDatas("doaction")&&(this.GetLastResult(!1),n=this.GetTaskID())),this.DoInit(),this.blWorking=!1,n},Create_Printer_List:function(e,t){for(;e.childNodes.length>0;)for(var n=e.childNodes,i=0;i<n.length;i++)e.removeChild(n[i]);for(var a=this.GET_PRINTER_COUNT(),s=0,i=0;i<a;i++){var r=document.createElement("option");if(r.innerHTML=this.GET_PRINTER_NAME(i),r.value=s,e.appendChild(r),s++,this.VERSION_EXT&&this.Printers.list[i].subdevlist.length>0)if(t)r.innerHTML=r.innerHTML+",..";else for(var o=r.innerHTML,l=0;l<this.Printers.list[i].subdevlist.length;l++){var h=this.Printers.list[i].subdevlist[l].id,u=this.Printers.list[i].subdevlist[l].name;if(0==l)r.innerHTML=o+","+u,r.value=o+","+h+";"+u;else if(r=document.createElement("option"),r.innerHTML=o+","+u,r.value=o+","+h+";"+u,e.appendChild(r),s++,s>=100)return}}},Create_PageSize_List:function(e,n){for(;e.childNodes.length>0;)for(var i=e.childNodes,a=0;a<i.length;a++)e.removeChild(i[a]);var s=t.GET_PAGESIZES_LIST(n,"\n"),r=new Array;r=s.split("\n");for(var a in r){var o=document.createElement("option");o.innerHTML=r[a],o.value=r[a],e.appendChild(o)}},AddItemArray:function(e,t,n,i,a,s,r,o,l,h,u,d,m,p){if(void 0===t||void 0===n||void 0===i||void 0===a||void 0===s)return!1;var c=this.ItemDatas.count;c++;var f={};for(var g in this.defStyleJson)f[g]=this.defStyleJson[g];return f.type=e,f.top=t,f.left=n,f.width=i,f.height=a,void 0!==s&&null!=s&&(f.content=s),void 0!==r&&null!=r&&(f.itemname=r+""),void 0!==o&&null!=o&&(f.shapetype=o),void 0!==l&&null!=l&&(f.penstyle=l),void 0!==h&&null!=h&&(f.penwidth=h),void 0!==u&&null!=u&&(f.fontcolor=u),void 0!==d&&null!=d&&(f.lineposition="1"),void 0!==m&&null!=m&&(f.fontname=m),void 0!==p&&null!=p&&(f.charttypess=p),f.beginpage=this.defStyleJson.beginpage,f.beginpagea=this.defStyleJson.beginpagea,this.ItemDatas.count=c,this.ItemDatas[c]=f,this.blNormalItemAdded=!0,!0},RemoveIframes:function(){var e=document.body||document.getElementsByTagName("body")[0]||document.documentElement;try{for(var t=0;t<this.Iframes.length;t++){var n=(new Date).getTime();n-this.Iframes[t].time>6e4*this.timeThreshold&&(e.removeChild(this.Iframes[t].iframe),this.Iframes.splice(t,1))}}catch(e){}},AddInputElement:function(e,t,n,i){if(void 0!==i){var a=e.createElement("input");a.name=n,a.type="hidden",a.value=i,t.appendChild(a)}},createPostDataString:function(e){var t="act="+e+this.DelimChar;t=t+"browseurl="+window.location.href+this.DelimChar;for(var n in this.PageDataEx)t=t+n+"="+this.PageDataEx[n]+this.DelimChar;var i="";for(var n in this.PageData)t=t+n+"="+this.PageData[n]+this.DelimChar,"top"!=n&&"left"!=n&&"width"!=n&&"height"!=n&&"printtask"!=n&&"printerindex"!=n&&"printerindexa"!=n&&"printersubid"!=n&&"orient"!=n&&"pagewidth"!=n&&"pageheight"!=n&&"pagename"!=n&&"printcopies"!=n&&"setup_bkimg"!=n&&(i=i+";"+n);""!==i&&(t=t+"printmodenames="+i+this.DelimChar);var a="";for(var s in this.ItemCNameStyles)t=t+s+"="+this.ItemCNameStyles[s]+this.DelimChar,a=a+";"+s;""!==a&&(t=t+"printstyleclassnames="+a+this.DelimChar),t=t+"itemcount="+this.ItemDatas.count+this.DelimChar;for(var r in this.ItemDatas){var o="";for(var l in this.ItemDatas[r])"beginpage"!=l&&"beginpagea"!=l&&"type"!=l&&"top"!=l&&"left"!=l&&"width"!=l&&"height"!=l&&(o=o+";"+l);t=t+r+"_itemstylenames="+o+this.DelimChar;for(var l in this.ItemDatas[r])t=t+r+"_"+l+"="+this.ItemDatas[r][l]+this.DelimChar}return t},wsDoPostDatas:function(e){var t="charset=丂"+this.DelimChar;return t=t+"tid="+this.GetTaskID()+this.DelimChar,t+=this.createPostDataString(e),this.wsSend("post:"+t)},DoPostDatas:function(e){if(1==this.blOneByone)return alert(this.altMessageSomeWindowExist),!1;if(this.blWorking=!0,null!==this.blTmpSelectedIndex&&this.SET_PRINTER_INDEX(this.blTmpSelectedIndex),this.SocketEnable)return this.wsDoPostDatas(e);this.RemoveIframes();var t=document.body||document.getElementsByTagName("body")[0]||document.documentElement,n=document.createElement("iframe");n.setAttribute("src","about:blank"),n.setAttribute("style","display:none"),n.height=0,t.appendChild(n);var i=n.contentWindow.document;i.write("<form action='"+this.strHostURI+"/c_dopostdatas' method='post' enctype='application/x-www-form-urlencoded'></form>");var a=i.getElementsByTagName("form")[0];this.AddInputElement(i,a,"charset","丂"),this.AddInputElement(i,a,"tid",this.GetTaskID()),this.AddInputElement(i,a,"post",this.createPostDataString(e)),a.submit();var s={};return s.time=(new Date).getTime(),s.iframe=n,this.Iframes.push(s),!0},GetLastResult:function(e){if(e&&(this.blOneByone=!0),this.SocketEnable)return!0;var n=this.strHostURI+"/c_lastresult.js";n=n+"?times="+(new Date).getTime(),n=n+"&tid="+this.GetTaskID(),n=encodeURI(n).replace("%20","+");var i=document.createElement("script");i.src=n,i.async=!1,i.type="text/javascript",i.charset="utf-8";var a=document.head||document.getElementsByTagName("head")[0]||document.documentElement;return a.insertBefore(i,a.firstChild),
i.onload=i.onreadystatechange=function(){if(!i.readyState||/loaded|complete/.test(i.readyState)){if(t.blOneByone=!1,CLodop_ACTLastResult)var e=decodeURIComponent(CLodop_ACTLastResult);var n=CLodop_ACTTaskID;if(t.Result=e,CLodop_ACTAlert&&CLodop_ACTAlert(),t.On_Return)try{var a=t.On_Return;"true"==e||"false"==e?t.On_Return(n,"true"==e):t.On_Return(n,e),t.On_Return_Remain||a!==t.On_Return||(t.On_Return=null)}catch(e){}i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i)}},!0},DoCPreview:function(e,t,n){var i=document.body||document.getElementsByTagName("body")[0]||document.documentElement;"number"!=typeof t?t=Math.round(2*i.offsetWidth/3):i.offsetWidth<t&&(t=i.offsetWidth),"number"!=typeof n?n=Math.round(window.screen.height-200):window.screen.height<n&&(n=window.screen.height);var a=this.strHostURI+"/c_dopreview";a=a+"?times="+(new Date).getTime(),a=a+"&tid="+this.GetTaskID(),a=a+"&iw="+t,a=a+"&ih="+n,a=encodeURI(a).replace("%20","+"),this.PopView(e,a,t,n)},PopView:function(e,t,n,i){try{e&&"string"==typeof e?"_"!=e.charAt(0)&&e.length>0?document.getElementById(e)?document.getElementById(e).src=t:alert("iframe '"+e+"' not exist!"):"_dialog"===e?this.Browser.Opera?window.open(t,"","scrollbars=yes,toolbar=no,left=150,top=100,resizable=yes"):showModalDialog(t,"dialog","center:yes"):"_self"===e||"_top"===e||"_parent"===e?window.location.href=t:"_blank"===e?this.PreviewBox.create(t,n,i):alert("Element '"+e+"' is invalid!"):this.PreviewBox.create(t,n,i)}catch(e){alert("CLODOP PopView "+e)}},creatMyButtonElement:function(e,t){try{var n=document.createElement("<input type='"+e+"' value='"+t+"'></input>")}catch(e){}return n||(n=document.createElement("input"),n.type=e,n.value=t),n},creatLabelElement:function(e,t,n,i,a){var s=document.createElement(e);return s.innerHTML=t,s.style.cssText="position:absolute;width:"+n+"px;left:"+i+"px;top:"+a+"px;",s},SelectBox:{dragapproved:!1,offsetx:0,offsety:0,tempx:0,tempy:0,FrantDiv:void 0,PopDiv:void 0,selPrinter:void 0,selCopies:void 0,closeit:function(){t.SelectBox.PopDiv&&t.SelectBox.PopDiv.parentNode&&t.SelectBox.PopDiv.parentNode.removeChild(t.SelectBox.PopDiv),this.FrantDiv&&this.FrantDiv.parentNode&&this.FrantDiv.parentNode.removeChild(this.FrantDiv),this.PopDiv=void 0},initializedrag:function(e){var t=window.event||e;this.offsetx=t.clientX,this.offsety=t.clientY,this.tempx=parseInt(this.PopDiv.style.left),this.tempy=parseInt(this.PopDiv.style.top),this.dragapproved=!0},drag_drop:function(e){if(this.dragapproved){var t=window.event||e;this.PopDiv.style.left=t.clientX-this.offsetx+this.tempx+"px",this.PopDiv.style.top=t.clientY-this.offsety+this.tempy+"px"}},stopdrag:function(){this.dragapproved=!1},clickOK:function(e){t.PRINTAOK(t.SelectBox.selPrinter.value,t.SelectBox.selCopies.value,0,0,e),this.closeit()},create:function(e,n,i){t.SelectBox.PopDiv&&this.closeit();var a=document.body||document.getElementsByTagName("body")[0]||document.documentElement,s=document.createElement("div");a.appendChild(s),s.style.cssText="position:absolute;z-index:91100;display:block;top:2px;border:1px solid #6B97C1;background:#F5F5F5;color:#000;font-size:13px;",s.style.width=e+"px",s.style.left=(a.offsetWidth-e)/2+"px",s.style.top=(a.offsetHeight-n)/2+"px",s.style.height=n+"px",this.PopDiv=s;var r=document.createElement("div");s.appendChild(r),r.style.cssText="font: bold 13px Arial;line-height:25px;height:27px;text-indent:5px;color: white;background:#8BACCF",r.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;打印",r.onmousedown=function(e){t.SelectBox.initializedrag(e)},r.onmousemove=function(e){t.SelectBox.drag_drop(e)},r.onmouseup=function(){t.SelectBox.stopdrag()};var o=document.createElement("button");r.appendChild(o),o.style.cssText="background:transparent url("+t.strHostURI+"/c_favicon.ico) no-repeat scroll 0 0px;margin-left:5px;position:absolute;height:20px;line-height:100px;width:34px;left:3px;border:0;top:5px";var l=document.createElement("button");r.appendChild(l),l.style.cssText="background:transparent url("+t.strHostURI+"/images/c_winclose.png) no-repeat scroll 0 0px;margin-right:5px;position:absolute;height:20px;line-height:100px;width:34px;right:3px;border:0;top:4px",l.onclick=function(){if(t.SelectBox.closeit(),i&&t.On_Return){var e=t.On_Return;t.On_Return(0,-1),t.On_Return_Remain||e!==t.On_Return||(t.On_Return=null)}};var h=document.createElement("div");s.appendChild(h),h.style.cssText="background:#F5F5F5;color:#000;border:0px;left:0px;top:0px;",h.style.width=e-2+"px",h.style.height=n-27+"px";var u=t.creatMyButtonElement("button","确定");s.appendChild(u),u.style.cssText="position:absolute;width:80px;f",u.style.left="110px",u.style.top=n-64+"px",u.onclick=function(){t.SelectBox.clickOK(i)};var d=t.creatMyButtonElement("button","取消");s.appendChild(d),d.style.cssText="position:absolute;width:80px;",d.style.left="240px",d.style.top=n-64+"px",d.onclick=function(){if(t.SelectBox.closeit(),i&&t.On_Return){var e=t.On_Return;t.On_Return(0,-1),t.On_Return_Remain||e!==t.On_Return||(t.On_Return=null)}},h.appendChild(t.creatLabelElement("span","选打印机：",200,46,67));var m=document.createElement("select");s.appendChild(m),this.selPrinter=m,m.style.cssText="position:absolute;size:1;width:212px;left:110px;top:62px;",t.Create_Printer_List(m),h.appendChild(t.creatLabelElement("span","打印份数：",200,46,121));var p=t.creatMyButtonElement("text","1");s.appendChild(p),this.selCopies=p,p.style.cssText="position:absolute;size:1;width:30px;left:110px;top:117px;",this.FrantDiv=document.createElement("div"),a.appendChild(this.FrantDiv),this.FrantDiv.style.cssText="border:0px;left:0px;top:0px;filter: alpha(opacity=20); position: fixed; opacity: 0.2;-moz-opacity: 0.2; _position: absolute;z-index:91009; over-flow: hidden;",t.Browser.IE&&("BackCompat"==document.compatMode||navigator.userAgent.indexOf("MSIE 6.0")>0)?(this.FrantDiv.style.width=a.scrollWidth+"px",this.FrantDiv.style.height=a.scrollHeight+"px"):(this.FrantDiv.style.width="100%",this.FrantDiv.style.height="100%")}},PreviewBox:{dragapproved:!1,offsetx:0,offsety:0,tempx:0,tempy:0,FrantDiv:void 0,PopDiv:void 0,ContentFrame:void 0,closeit:function(e){t.PreviewBox.PopDiv&&t.PreviewBox.PopDiv.parentNode&&t.PreviewBox.PopDiv.parentNode.removeChild(t.PreviewBox.PopDiv),this.FrantDiv&&this.FrantDiv.parentNode&&this.FrantDiv.parentNode.removeChild(this.FrantDiv),this.PopDiv=void 0},initializedrag:function(e,t){var n=window.event||e;this.offsetx=n.clientX,this.offsety=n.clientY,this.tempx=parseInt(t.style.left),this.tempy=parseInt(t.style.top),this.dragapproved=!0},drag_drop:function(e,t){if(this.dragapproved){var n=window.event||e;t.style.left=n.clientX-this.offsetx+this.tempx+"px",t.style.top=n.clientY-this.offsety+this.tempy+"px"}},stopdrag:function(){this.dragapproved=!1,this.ContentFrame&&(this.ContentFrame.style.display="block")},create:function(e,n,i){t.PreviewBox.PopDiv&&this.closeit();var a=document.body||document.getElementsByTagName("body")[0]||document.documentElement,s=document.createElement("div");a.appendChild(s),s.style.cssText="position:absolute;z-index:91100;display:block;top:2px;border:1px solid #6B97C1;font-size:13px;",s.style.width=n+"px";var r=(a.offsetWidth-n)/2;window.screen.width<a.offsetWidth&&(r=(window.screen.width-n)/2),r<0&&(r=0),s.style.left=r+"px",s.style.height=i+"px",s.onmousedown=function(e){t.PreviewBox.initializedrag(e,this)},s.onmouseup=function(){t.PreviewBox.stopdrag()},s.onmousemove=function(e){t.PreviewBox.drag_drop(e,this)},this.PopDiv=s;var o=document.createElement("div");s.appendChild(o),o.style.cssText="position:absolute;left:0px;width:100%;font: bold 14px Arial;line-height:27px;height:27px;text-indent:26px;color: white;background:#8BACCF",o.innerHTML="打印预览";var l=document.createElement("button");o.appendChild(l),l.style.cssText="background:transparent url("+t.strHostURI+"/c_favicon.ico) no-repeat scroll 0 0px;margin-left:5px;position:absolute;height:20px;line-height:100px;width:34px;left:3px;border:0;top:5px";var h=document.createElement("button");o.appendChild(h),h.style.cssText="background:transparent url("+t.strHostURI+"/images/c_winclose.png) no-repeat scroll 0 0px;margin-right:5px;position:absolute;height:20px;line-height:100px;width:34px;right:3px;border:0;top:4px",h.onclick=function(){t.PreviewBox.closeit(this)};var u=document.createElement("div");s.appendChild(u),u.style.cssText="background:#F5F5F5;color:#000;border:0px;left:0px;top:0px;",u.style.width=n+"px",u.style.height=i-0+"px",this.ContentFrame=document.createElement("iframe"),u.appendChild(this.ContentFrame),this.ContentFrame.style.cssText="width:100%;height:100%;",this.ContentFrame.src=e,this.ContentFrame.frameBorder="no",this.FrantDiv=document.createElement("div"),a.appendChild(this.FrantDiv),this.FrantDiv.style.cssText="border:0px;left:0px;top:0px;filter: alpha(opacity=20); position: fixed; opacity: 0.2; -moz-opacity: 0.2; _position: absolute;z-index:91009; over-flow: hidden;",t.Browser.IE&&("BackCompat"==document.compatMode||navigator.userAgent.indexOf("MSIE 6.0")>0)?(this.FrantDiv.style.width=a.scrollWidth+"px",this.FrantDiv.style.height=a.scrollHeight+"px"):(this.FrantDiv.style.width="100%",this.FrantDiv.style.height="100%")}}};return e.CLODOP2015_7028&&e.CLODOP2015_7028.Priority&&e.CLODOP2015_7028.Priority>t.Priority?(t=e.CLODOP2015_7028,void(e.CLODOP_OK_Priority=e.CLODOP2015_7028.Priority)):(e.LODOP=t,e.CLODOP=t,e.CLODOP2015_7028=t,e.CLODOP_OK_Priority=t.Priority,e.CLODOP.DoInit(),void(navigator.userAgent.indexOf("Lodop")<0&&e.CLODOP.OpenWebSocket()))})(window);