(function(a,t,e,s){function i(a){var t=a.getFullYear(),e=a.getMonth()+1,s=a.getDate();return e=e<=9?"0"+e:""+e,s=s<=9?"0"+s:""+s,t+e+s}function n(a){var t=a.split("-");return new Date(t[0],t[1]-1,t[2])}function l(a){return a.substr(0,4)+"-"+a.substr(4,2)+"-"+a.substring(6)}var r=function(t,e){this.$calendar=t,this.defaults={ifSwitch:!0,backToday:!1},this.options=a.extend({},this.defaults,e)};r.prototype={showCalendar:function(){var t=this,e=c.getDate().getFullYear(),s=c.getDate().getMonth()+1,n=i(c.getDate()),l=new Date(e,s-1,1);if(this.$calendarTitle_text.text(e+"年"+n.substr(4,2)+"月"),this.$calendarDate_item.each(function(t){var n=new Date(e,s-1,t+1-l.getDay()),r=i(n);a(this).text(n.getDate()).attr("data",r),i(new Date)===r?a(this).attr("class","item item-curDay"):i(l).substr(0,6)===r.substr(0,6)?a(this).attr("class","item item-curMonth"):a(this).attr("class","item")}),t.selected_data){var r=t.$calendar_date.find("[data="+t.selected_data+"]");r.addClass("item-selected")}},renderDOM:function(){this.$calendar_title=a('<div class="calendar-title"></div>'),this.$calendar_week=a('<ul class="calendar-week"></ul>'),this.$calendar_date=a('<ul class="calendar-date"></ul>'),this.$calendar_today=a('<div class="calendar-today"></div>');for(var t='<a href="javascript:;" class="arrow-prev">&lt;&lt;</a><span class="title"></span><a href="javascript:;" class="arrow-next">&gt;&gt;</a>',e='<li><span class="item">日</span></li><li><span class="item">一</span></li><li><span class="item">二</span></li><li><span class="item">三</span></li><li><span class="item">四</span></li><li><span class="item">五</span></li><li><span class="item">六</span></li>',s="",i='<i class="triangle"></i><p class="date"></p><p class="week"></p>',n=0;n<6;n++)s+='<li><span class="item"></span></li><li><span class="item"></span></li><li><span class="item"></span></li><li><span class="item"></span></li><li><span class="item"></span></li><li><span class="item"></span></li><li><span class="item"></span></li>';this.$calendar_title.html(t),this.$calendar_week.html(e),this.$calendar_date.html(s),this.$calendar_today.html(i),this.$calendar.append(this.$calendar_title,this.$calendar_week,this.$calendar_date,this.$calendar_today),this.$calendar.show()},inital:function(){var t=this;if(this.renderDOM(),this.$calendarTitle_text=this.$calendar_title.find(".title"),this.$backToday=a("#backToday"),this.$arrow_prev=this.$calendar_title.find(".arrow-prev"),this.$arrow_next=this.$calendar_title.find(".arrow-next"),this.$calendarDate_item=this.$calendar_date.find(".item"),this.$calendarToday_date=this.$calendar_today.find(".date"),this.$calendarToday_week=this.$calendar_today.find(".week"),this.selected_data=0,this.showCalendar(),this.options.ifSwitch&&(this.$arrow_prev.bind("click",function(){var a=c.getDate();c.setDate(new Date(a.getFullYear(),a.getMonth()-1,1)),t.showCalendar()}),this.$arrow_next.bind("click",function(){var a=c.getDate();c.setDate(new Date(a.getFullYear(),a.getMonth()+1,1)),t.showCalendar()})),this.options.backToday){var e=c.getDate().getMonth()+1;this.$backToday.bind("click",function(){var s=a(".item-curMonth").eq(0).attr("data").substr(4,2),i=s!=e;t.$calendarDate_item.hasClass("item-curDay")&&!i||(c.setDate(new Date),t.showCalendar())})}this.$calendarDate_item.click(function(){var e=a(this).attr("data"),s=n(l(e)),i=null;t.selected_data=a(this).attr("data"),c.setDate(new Date(s.getFullYear(),s.getMonth(),1)),a(this).hasClass("item-curMonth")||t.showCalendar(),i=t.$calendar_date.find("[data="+e+"]"),$curDay=t.$calendar_date.find(".item-curDay"),i.hasClass("item-selected")||(t.$calendarDate_item.removeClass("item-selected"),i.addClass("item-selected"))})},constructor:r},a.fn.calendar=function(a){var t=new r(this,a);return t.inital()};var c=function(){var a=new Date;return{getDate:function(){return a},setDate:function(t){a=t}}}()})(jQuery,window,document);