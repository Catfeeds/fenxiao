$(function(){function n(){uploadFile("main_header",{browse_button:"upload-banner",container:"upload-banner-container",drop_element:"upload-banner-container",max_file_size:"1mb",chunk_size:"1mb",init:{FileUploaded:function(n,e,t){var i=JSON.parse(t.response),d=n.getOption("domain")+i.key;a(d),p.find(".upload-again").show()}}})}function e(){$.getJSON(__BASEURL__+"mshop/decorate_api/get_xcx_index_data",{module_id:3},function(n){if(n.success){var n=n.data;if(!n)return void i();g=n.id,n.module_data&&n.module_data.img&&(m=n.module_data.img),n.module_data&&n.module_data.title&&(b=n.module_data.title),t(b),a(m),p.find(".upload-plus").hide(),n.module_data.img&&n.module_data.title?d():i()}else new Msg({type:"danger",msg:n.msg})})}function t(n){o.val(b),s.text(b)}function a(n){l.val(n),u.attr("src",n),p.find(".upload-pic").attr("src",n)}function i(){$btnEdit.hide(),r.show(),o.prop("disabled",!1),c.show().next().show(),p.find(".upload-again").show()}function d(){$btnEdit.show(),r.hide(),o.prop("disabled",!0),c.hide().next().hide(),p.find(".upload-again").hide()}var o=$("#title"),s=$("#phone-title"),l=$("#banner"),u=$("#xcx-banner"),c=$("#upload-banner"),p=$("#upload-banner-container"),r=$(".action-box"),_=$("#btn-cancel");$btnEdit=$("#btn-edit"),$btnSave=$("#btn-save");var g="",m="http://oydp172vs.bkt.clouddn.com/wsc_goods/1521599389689_8452.png",b="";n(),e(),o.on("input",function(){s.text(o.val())}),_.on("click",function(){d(),t(b),a(m)}),$btnEdit.on("click",function(){i()}),$btnSave.on("click",function(){var n=l.val(),e=o.val();return n?e?e.length>20?(new Msg({type:"danger",msg:"标题不得超过20个字符"}),!1):($btnSave.prop("disabled",!0).text("保存中..."),void $.post(__BASEURL__+"mshop/decorate_api/save_module_data",autoCsrf({id:g,module_id:3,json:JSON.stringify({img:n,title:e,is_on:1}),is_save:1,shop_id:0}),function(t){$btnSave.prop("disabled",!1).text("保存"),t.success?(m=n,b=e,d(),new Msg({type:"success",msg:"保存成功"})):new Msg({type:"danger",msg:t.msg})})):(new Msg({type:"danger",msg:"标题不能为空"}),!1):(new Msg({type:"danger",msg:"请上传banner图"}),!1)})});