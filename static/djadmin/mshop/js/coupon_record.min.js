$(function(){function o(){var o,t;switch(r){case"2":o=__BASEURL__+"mshop/promotion/coupon_follow",t="关注优惠券";break;case"1":default:o=__BASEURL__+"mshop/promotion/coupon_list",t="裂变优惠券"}a.attr("href",o).text(t)}function t(o){$.post(__BASEURL__+"mshop/coupon_api/record/"+r,autoCsrf({status:i,mobile:s,current_page:o||1,page_size:u}),function(c){if(c.success){var e=Math.ceil(+c.data.total/u);$("#couponRecordTbody").html(template(couponRecordTpl,c.data)),laypage({cont:"couponRecordPage",pages:e,curr:o||1,skin:"#5aa2e7",first:1,last:e,skip:!0,prev:"&lt",next:"&gt",jump:function(o,c){c||(t(o.curr),p=o.curr)}})}})}var c=$("#status"),e=$("#mobile"),n=$("#btn-search"),a=$("#coupon_type"),r=GetQueryString("coupon_type")||"1";couponRecordTpl=document.getElementById("couponRecordTpl").innerHTML;var p=1,u=10,i=c.val(),s=e.val();o(),t(p),c.on("change",function(){i=$(this).val(),t(1)}),n.on("click",function(){s=e.val(),t(1)})});