$(function(){function e(){m.prop("disabled",!1),p.data("bootstrapValidator").destroy(),p.data("bootstrapValidator",null),s()}function s(){p.bootstrapValidator({fields:{shop_id:{validators:{notEmpty:{message:"门店不能为空"}}},fubei_id:{validators:{notEmpty:{message:"银行通道不能为空"}}}}}).on("success.form.bv",function(e){e.preventDefault();var s=a.val(),t=d.val();m.prop("disabled",!0),$.post(__BASEURL__+"mshop/fubei_config_api/shop_edit",autoCsrf({shop_id:s,fubei_id:t}),function(e){m.prop("disabled",!1),l.modal("hide"),e.success?(new Msg({type:"success",msg:e.msg}),o()):new Msg({type:"danger",msg:e.msg})})})}function t(){$.getJSON(__BASEURL__+"mshop/fubei_config_api/list",{current_page:1,page_size:1e4},function(e){if(e.success){var s=e.data;d.html(template(_,s))}else new Msg({type:"danger",msg:e.msg})})}function o(){$.getJSON(__BASEURL__+"mshop/fubei_config_api/shop_list",function(e){if(e.success){var s=e.data;$("#shopTbody").html(template(f,s))}else new Msg({type:"danger",msg:e.msg})})}function i(s,t,o){e(),a.val(s),n.text(t),d.val(o),l.modal("show")}var a=$("#shop_id"),n=$("#shop_name"),d=$("#fubei_id"),p=$("#shop-form"),l=$("#editShopModal"),m=$("#edit-confirm"),_=document.getElementById("fubeiTpl").innerHTML,f=document.getElementById("shopTpl").innerHTML;s(),o(),t(),window.editShop=i});